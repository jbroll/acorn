#!/usr/bin/env tclkit8.6
#
lappend auto_path ./lib ../lib

package require acorn
source  acorn-model.tcl

acorn::model GMT {
    surface Primary	{ R -36000.0	  K  -0.99828570	n  -1.00	thickness -20262.476419940002 
   		  aper_type UDA aper_param m1aper1e.uda
    }

    surface Secondary	{ R   4163.900922 K  -0.71692784	n  -1.00	thickness  20262.476419940002	}
    surface .		{ 							thickness   4900      		}
    surface .		{        						thickness    620      		}
    surface .   	{ 							thickness    310      		}
    surface Fous	{ 							thickness      0      		}
}



acorn::Rays new rays 9

proc run-rays {} {
    set i 0
    foreach x [jot 11 -12700 12700] {
	foreach y [jot 11 -12700 12700] {
	    rays $i set px $x py $y pz 0 kx 0.0 ky 0.0 kz 1.0 vignetted 0
	    incr i
	}
    }

    GMT trace rays

    puts "x     	y     	z      	v"
    puts "-------	-------	-------	-"
    puts [join [map row [rays 0 end get px py pz vignetted] { join [map x $row { format "% 11.4f" $x }] \t }] \n]
}

run-rays

#GMT Primary set rz 90
#run-rays
#
#GMT Primary set rz 180
#run-rays

